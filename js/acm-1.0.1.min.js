for(var navbar=document.getElementById("topnav"),items=navbar.getElementsByClassName("nav-item"),i=0;i<items.length;i++)items[i].addEventListener("click",function(){var e=document.getElementsByClassName("active");e[0].className=e[0].className.replace(" active",""),this.className+=" active"});var modalIsVisible=!1,paymentLoaded=!1,secretModeActivated=!1,videoHasNotBeenLoaded=!0,pendingVideoRequest=!1,braintreeClientAlreadyCreated=!1;function createCORSRequest(e,t){var a=new XMLHttpRequest;return"withCredentials"in a?a.open(e,t,!0):"undefined"!=typeof XDomainRequest?(a=new XDomainRequest).open(e,t):a=null,a}function validateCrimsonEmail(e){var t=e.trim();return/[^@]+@.+[^@]ua.edu/.test(t)}function toggleResponsiveNav(e){$("#topnav").toggleClass("responsive"),$("#hamburger").toggleClass("hamburger-margin")}$(document).ready(function(){$.ajax({url:"https://"+UTIL_INSTANCE_NAME+".herokuapp.com/member/wakeup",type:"GET"}),$.ajax({url:"https://"+PAYMENTS_INSTANCE_NAME+".herokuapp.com/wakeup",type:"GET"}),$.validator.methods.email=function(e,t){return this.optional(t)||/[^@]+@.+[^@]ua.edu/.test(e)},$("form[name='joinForm']").validate({rules:{firstName:"required",lastName:"required",email:{required:!0,email:!0}},messages:{firstName:"Please enter your first name",lastName:"Please enter your last name",email:"Please enter a valid Crimson email address"}}),$("#joinForm").submit(function(e){e.preventDefault()}),$("#secret-mode").on("click",function(){$("#normalHeader").toggle(),$("#normalHeader").is(":visible")?$("#sexyHeader").css("display","none"):$("#sexyHeader").css("display","flex"),secretModeActivated=secretModeActivated?($("#secret-mode").text("secret mode"),$("body").css("font-family","'Trebuchet MS', Helvetica, sans-serif"),!1):($("#secret-mode").text("revert to classic"),$("body").css("font-family","Courier"),!0),$("html, body").animate({scrollTop:0},"slow")}),$("#super-secret-admin-portal").on("click",function(){window.open("admin_portal.html")}),$("#email-btn").on("input",function(){$("#join-email-field").val($("#email-btn").val()),$("#pay-email").val($("#email-btn").val())}),$(window).scroll(function(e){$el=$(".custom-nav"),$(this).scrollTop()>$("#home").height()&&"fixed"!=$el.css("position")&&$(".custom-nav").css({position:"fixed",top:"0",left:"0"}),$(this).scrollTop()<$("#home").height()&&"fixed"==$el.css("position")&&$(".custom-nav").css({position:"",top:""})}),$(".join-btn").on("click keydown",function(e){(13==e.which||0<e.which&&e.which<4)&&(modalIsVisible=!0,$("#joinModal").show())}),$("#close-join").on("click",function(e){modalIsVisible=!1,$("#joinModal").hide(),$("#error").hide()}),$(".pay-btn").on("click keydown",function(e){(13==e.which||0<e.which&&e.which<4)&&(modalIsVisible=!0,$("#payModal").show(),paymentLoaded||(loadPaymentView(),paymentLoaded=!0))}),$("#close-pay").on("click",function(e){modalIsVisible=!1,$("#payModal").hide(),$("#payment-error").hide(),$("#member-error").hide(),$("#valid-error").hide(),$("#processing-payment").hide(),$("#processing-status").hide()});$("#submit-join").on("click",function(e){var t=$("#joinForm");if(t.validate(),t.valid()){var a=function(e){var t=e.serializeArray(),a={};return $.map(t,function(e,t){a[e.name]=e.value}),a}($("#joinForm"));$("#loading-join").show(),$("#submit-join").hide(),$.post({url:"https://"+UTIL_INSTANCE_NAME+".herokuapp.com/join",beforeSend:function(e){e.setRequestHeader("Access-Control-Allow-Origin","*")},data:JSON.stringify(a),contentType:"application/json",dataType:"json",success:function(e){1==e.success?($("#joinModal").animate({scrollTop:0},300),$(".success-form","#joinModal").show(),$(".form-container","#joinModal").hide()):alert(e.errorMessage),$("#loading-join").hide(),$("#submit-join").show()}})}e.preventDefault()}),$("#print-receipt").click(function(e){e.preventDefault(),function(e){var t=window.open("","PRINT","height=400,width=600");t.document.write("<html><head><title>"+document.title+"</title>"),t.document.write("</head><body >"),t.document.write("<h1>"+document.title+"</h1>"),t.document.write(document.getElementById(e).innerHTML),t.document.write('<div><button onclick="printPage()">Print this page</button></div>'),t.document.write("</body><script>function printPage() {window.print();}<\/script></html>"),t.focus()}("receipt")}),$("a").on("click",function(e){var t=$("#topnav").height()+45;if("fixed"==$("#topnav").css("position")&&(t=$("#topnav").height()),""!==this.hash){e.preventDefault();var a=this.hash,n=$(a);$("html, body").animate({scrollTop:n.offset().top-t},900,"swing",function(){})}}),$("#right-paddle").on("click",function(){$("#companies-logos").animate({scrollLeft:800},500),$("#mobile-scroll-notice").fadeOut(500)}),$("#left-paddle").on("click",function(){$("#companies-logos").animate({scrollLeft:0},500),$("#mobile-scroll-notice").fadeOut(500)}),$("#companies-logos").on("scroll",function(){$("#mobile-scroll-notice").fadeOut(500)})});var email=$("#pay-email"),shirtSize=$("#pay-shirt-size"),alerts=$(".label-alert-hide"),presubmitPaymentBtn=$("#proceed-to-payment-btn"),submitPaymentBtn=$("#pay-confirm");function loadPaymentScript(e,t){var a=document.createElement("script");a.type="text/javascript",a.readyState?a.onreadystatechange=function(){"loaded"!=a.readyState&&"complete"!=a.readyState||(a.onreadystatechange=null,t())}:a.onload=function(){t()},a.src=e,document.getElementsByTagName("head")[0].appendChild(a)}function loadPaymentView(){presubmitPaymentBtn.on("click",function(e){e.preventDefault(),$("#loading-presubmit-wheel").show(),$("#proceed-to-payment-btn").hide();var t=!0;validateCrimsonEmail(email.val())||(alerts.eq(0).attr("class","label-alert-show"),email.addClass("alert"),t=!1),"none"==shirtSize.val()&&(alerts.eq(1).attr("class","label-alert-show"),shirtSize.addClass("alert"),t=!1),t?$.post({url:"https://"+UTIL_INSTANCE_NAME+".herokuapp.com/member/checkMemberForDues",beforeSend:function(e){e.setRequestHeader("Access-Control-Allow-Origin","*")},data:JSON.stringify({email:email.val().trim()}),contentType:"application/json",dataType:"json",success:function(e){1==e.success?($("#payModal").animate({scrollTop:0},300),$("#pay-selection-header").show(),$("#pay-review-btn").show(),$("#payment-card-details-wrapper").show(),$("#payment-dropin").show(),$("#loading-payment-details").show(),$("#pay-dropin-cancel-btn").show(),$("#loading-presubmit-wheel").hide(),$("#member-pay-details-form").hide(),$("#pay-dropin-cancel-btn").on("click",function(e){e.preventDefault(),$("#payModal").animate({scrollTop:0},300),$("#pay-review-btn").show(),$("#pay-dropin-cancel-btn").hide(),$("#pay-selection-header").hide(),$("#pay-review-btn").hide(),$("#proceed-to-payment-btn").show(),$("#payment-card-details-wrapper").hide(),$("#payment-dropin").hide(),$("#member-pay-details-form").show(),$("#loading-payment-details").remove()}),braintreeClientAlreadyCreated||loadPaymentScript("https://js.braintreegateway.com/web/dropin/1.11.0/js/dropin.min.js",function(){loadPaymentScript("https://js.braintreegateway.com/web/3.34.0/js/venmo.min.js",function(){loadPaymentScript("https://js.braintreegateway.com/web/3.34.0/js/client.min.js",function(){loadPaymentScript("https://js.braintreegateway.com/web/3.34.0/js/data-collector.min.js",function(){braintreeClientAlreadyCreated=!0;var e=createCORSRequest("GET","https://"+PAYMENTS_INSTANCE_NAME+".herokuapp.com/client_token");e.open("GET","https://"+PAYMENTS_INSTANCE_NAME+".herokuapp.com/client_token"),e.onreadystatechange=function(){4==e.readyState&&200==e.status&&($("#loading-payment-details").hide(),braintree.client.create({authorization:e.responseText},function(e,t){e?console.error("Error creating client:",e):(braintree.dataCollector.create({client:t,kount:!0},function(e,t){if(!e)t.deviceData}),braintree.venmo.create({client:t},function(e,t){e&&console.error("Error creating Venmo:",e)}))}),braintree.dropin.create({authorization:e.responseText,container:"#dropin-container",venmo:{allowNewBrowserTab:!1},dataCollector:{kount:!0}},function(e,t){$(".braintree-toggle").click(function(){$("#pay-confirm-container").is(":visible")&&($("#payModal").animate({scrollTop:0},300),$("#pay-dropin-cancel-btn").show(),$("#pay-review-btn").show(),$("#confirmation-buttons").show(),$("#pay-selection-header").show(),$("#confirmation-buttons").hide(),$("#pay-confirm-container").hide())}),$("#pay-review-btn").on("click",function(e){e.preventDefault(),$("#payModal").animate({scrollTop:0},300),$("#proceed-to-payment-btn").hide(),$("#member-pay-details-form").hide(),$("#pay-dropin-cancel-btn").hide(),$("#pay-review-btn").hide(),$("#loading-verifying-payment").show(),$("#back-to-payment-selection-btn").click(function(e){e.preventDefault(),$("#payModal").animate({scrollTop:0},300),$("#pay-dropin-cancel-btn").show(),$("#pay-review-btn").show(),$("#confirmation-buttons").show(),$("#pay-selection-header").show(),$("#confirmation-buttons").hide(),$("#pay-confirm-container").hide()}),t.requestPaymentMethod(function(e){e?($("#loading-verifying-payment").hide(),$("#pay-dropin-cancel-btn").show(),$("#pay-review-btn").show()):($("#loading-verifying-payment").hide(),$("#confirmation-buttons").hide(),$("#pay-selection-header").hide(),$("#confirmation-buttons").show(),$("#pay-confirm-container").show(),$("#email-confirmation").html(email.val().trim()),$("#size-confirmation").html(shirtSize.val()),$("#pay-confirm").on("click",function(e){e.preventDefault(),t.requestPaymentMethod(function(e,t){$("#processing-payment").show(),$("#confirmation-buttons").hide();var a=createCORSRequest("POST","https://"+PAYMENTS_INSTANCE_NAME+".herokuapp.com/checkout");a.open("POST","https://"+PAYMENTS_INSTANCE_NAME+".herokuapp.com/checkout"),a.setRequestHeader("content-type","application/json"),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){$("#payModal").animate({scrollTop:0},300),$("#processing-payment").hide();var e=JSON.parse(JSON.parse(a.responseText).text);0==e.success?(alert(e.errorMessage),$("#payment-error").show(),$("#confirmation-buttons").show()):($("#payForm").hide(),$("#pay-complete").show(),$("#pay-confirm-container").hide(),$("#payment-card-details-wrapper").hide(),$("#confirmation-buttons").hide(),$("#payment-error").hide(),$("#member-error").hide(),$("#processing-status").show(),$("#receipt-name").html(e.name),$("#receipt-type").html(e.paymentType),$("#receipt-id").html(e.id),$("#receipt-date").html(e.date),$("#receipt-card").html(e.cardType+" "+e.hiddenCCNumber))}else 4==a.readyState&&200!=a.status&&($("#processing-payment").hide(),$("#payment-error").show())},a.send(JSON.stringify({nonce:t.nonce,device_data:t.deviceData,email:email.val().trim(),size:shirtSize.val()}))})}))})})}))},e.send()})})})})):(alert(e.errorMessage),$("#loading-presubmit-wheel").hide(),$("#proceed-to-payment-btn").show())}}):($("#loading-presubmit-wheel").hide(),$("#proceed-to-payment-btn").show())})}email.on("click",function(){alerts.eq(0).attr("class","label label-alert-hide"),email.removeClass("alert")}),shirtSize.on("click",function(){alerts.eq(1).attr("class","label label-alert-hide"),shirtSize.removeClass("alert")});